{"ast":null,"code":"import _classCallCheck from\"/Users/john/Downloads/library2/lib/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/john/Downloads/library2/lib/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/john/Downloads/library2/lib/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/john/Downloads/library2/lib/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/john/Downloads/library2/lib/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/john/Downloads/library2/lib/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import Card from'react-bootstrap/Card';import CardColumns from'react-bootstrap/CardColumns';import Button from'react-bootstrap/Button';import firebase from'../../firebase';import'./Library.css';import ReactLoading from'react-loading';import OverlayTrigger from'react-bootstrap/OverlayTrigger';import Popover from'react-bootstrap/Popover';import Slide from'react-reveal/Slide';import*as login from'../Auth/Login.js';import Avatar from'react-avatar';var BASE_URL=\"https://www.googleapis.com/books/v1/volumes\";var db=firebase.firestore();//if bookcount > 0 then display cards otherwise display \"you have no books here. Search for your favourites and add the to your library!\"\nvar Library=/*#__PURE__*/function(_React$Component){_inherits(Library,_React$Component);function Library(props){var _this;_classCallCheck(this,Library);_this=_possibleConstructorReturn(this,_getPrototypeOf(Library).call(this,props));_this.addBook=function(name,author,image,description){var addBook=db.collection('Users').doc(login.getUID()).collection('Library').doc(name).set({title:name,author:author,description:description,coverurl:image}).then(function(){console.log(\"Document successfully written!\");}).catch(function(error){console.error(\"Error writing document: \",error);});};_this.toolTap=function(title,author,description,image){return React.createElement(Popover,{id:\"popover-basic\"},React.createElement(Popover.Title,{as:\"h3\"},title),React.createElement(Popover.Content,null,description,React.createElement(\"br\",null),React.createElement(Button,{variant:\"secondary\",type:\"submit\",onClick:function onClick(){_this.addBook(title,author,description,image);},size:\"sm\"},\"Shelf\")));};_this.handleRemoveBook=function(name){var docRef=db.collection(\"Library\").doc(name).delete().then(function(){alert(\"Document deleted\");window.location.reload();}).catch(function(error){console.error(\"Error deleting document: \",error);});};_this.current=function(name,author,description,image){var friendUid=_this.props.location.state.friendUid;var addBook=db.collection(\"Users\").doc(friendUid).collection(\"Library\").get().then(function(querySnapshot){var data=querySnapshot.docs.map(function(doc){return doc.data();});console.log(\"friends data: \"+data);_this.setState({current:data});_this.handleRemoveBook=_this.handleRemoveBook.bind(_assertThisInitialized(_this));});};_this.state={bookcount:0,data:'',delete:false,show:false,setShow:false,current:\"\",fname:\"\"};return _this;}_createClass(Library,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var _this$props$location$=this.props.location.state,friendUid=_this$props$location$.friendUid,friendName=_this$props$location$.friendName;this.setState({fname:friendName});console.log(\"friends uid: \"+friendUid+\" \"+friendName);db.collection(\"Users\").doc(friendUid).collection(\"Library\").get().then(function(querySnapshot){var data=querySnapshot.docs.map(function(doc){return doc.data();});console.log(\"friends data: \"+data);_this2.setState({bookcount:data.length,data:data});_this2.handleRemoveBook=_this2.handleRemoveBook.bind(_this2);});}},{key:\"getBooks\",value:function getBooks(){db.collection(\"Library\").get().then(function(querySnapshot){var data=querySnapshot.docs.map(function(doc){return doc.data();});return data;});}},{key:\"setShow\",value:function setShow(show){this.setState({show:!show});}},{key:\"render\",value:function render(){var _this3=this;var xxx=\" \";var friendUid=this.props.location.state.friendUid;db.collection('Users').doc(friendUid).get().then(function(querySnapshot){//var cata = querySnapshot.docs.map(doc => doc.data());\n//  console.log(cata);\n});db.collection('Users').doc(friendUid).collection('CurrentBook').get().then(function(querySnapshot){var currentdata=querySnapshot.docs.map(function(doc){return doc.data();});_this3.setState({current:currentdata[0]});});if(this.state.bookcount>0){if(this.state.current!==undefined){var deleted=this.state.delete;return React.createElement(\"div\",{className:\"library\"},React.createElement(\"h1\",{style:{color:\"white\"}},this.state.fname,\"'s Library \"),React.createElement(CardColumns,{className:\"post\"},React.createElement(Card,{className:\"currentRead\"},React.createElement(Avatar,{className:\"ava\",name:this.state.fname,round:true}),React.createElement(Card.Title,null,this.state.fname,\" is reading\"),React.createElement(Card.Subtitle,null,this.state.current.title,\" by \",this.state.current.author),React.createElement(Card.Img,{style:{width:'100px'},src:this.state.current.coverurl})),this.state.data.map(function(data,index){return React.createElement(\"div\",null,React.createElement(Slide,{bottom:true},React.createElement(Card,{className:\"imgCardlib\",key:data.uniqueId},React.createElement(OverlayTrigger,{trigger:\"click\",placement:\"bottom\",overlay:_this3.toolTap(data.title,data.author,data.description,data.coverurl)},React.createElement(Card.Img,{\"data-tip\":true,\"data-for\":\"clickme\",\"data-event\":\"click\",variant:\"top\",src:data.coverurl,style:{width:'10em',marginBottom:'30px',paddingRight:'0px'}})))));})));}else{var deleted=this.state.delete;return React.createElement(\"div\",{className:\"library\"},React.createElement(\"h1\",{style:{color:\"white\"}},this.state.fname,\"'s Library \"),React.createElement(CardColumns,{className:\"post\"},React.createElement(Card,{className:\"currentRead\"},React.createElement(Avatar,{style:{marginBottom:'30px'},className:\"ava\",name:this.state.fname,round:true}),React.createElement(Card.Title,null,this.state.fname,\" is not reading anything!\")),this.state.data.map(function(data,index){return React.createElement(\"div\",null,React.createElement(Slide,{bottom:true},React.createElement(Card,{className:\"imgCardlib\",key:data.uniqueId},React.createElement(OverlayTrigger,{trigger:\"click\",placement:\"bottom\",overlay:_this3.toolTap(data.title,data.author,data.description,data.coverurl)},React.createElement(Card.Img,{\"data-tip\":true,\"data-for\":\"clickme\",\"data-event\":\"click\",variant:\"top\",src:data.coverurl,style:{width:'10em',marginBottom:'30px',paddingRight:'0px'}})))));})));}}return React.createElement(\"div\",{className:\"emptylibrary\"},React.createElement(\"div\",{className:\"loading\"},React.createElement(ReactLoading,{type:\"cubes\",height:\"100vh\",color:\"white\"})));}}]);return Library;}(React.Component);export{Library as default};function bookimagecheck(index,books){if(books.items[index].volumeInfo.imageLinks===undefined){console.log(\"undefined image! @ \"+books.items[index]);return'../images/cannotfind.png';}else{return books.items[index].volumeInfo.imageLinks.thumbnail;}}function descriptioncheck(index,books){var descript=books.items[index].volumeInfo.description;var length=135;if(descript!==undefined){if(descript.length>=length){descript=descript.substring(0,length-3)+\"...\";return descript;}else{return descript;}}else{return\"no description available\";}}function authorCheck(index,books){console.log(books.items[index].volumeInfo.authors);if(books.items[index].volumeInfo.authors===undefined){return'';}else{var tempstring=\"\";var authlen=books.items[index].volumeInfo.authors.length;for(var i=0;i<authlen;i++){if(authlen>1){if(i===authlen-1){tempstring=tempstring+books.items[index].volumeInfo.authors[i];}else{tempstring=tempstring+books.items[index].volumeInfo.authors[i]+\", \";}}else{tempstring=tempstring+books.items[index].volumeInfo.authors[i]+\" \";}}return tempstring;}}","map":{"version":3,"sources":["/Users/john/Downloads/library2/lib/src/components/Library/FriendsLibrary.js"],"names":["React","Card","CardColumns","Button","firebase","ReactLoading","OverlayTrigger","Popover","Slide","login","Avatar","BASE_URL","db","firestore","Library","props","addBook","name","author","image","description","collection","doc","getUID","set","title","coverurl","then","console","log","catch","error","toolTap","handleRemoveBook","docRef","delete","alert","window","location","reload","current","friendUid","state","get","querySnapshot","data","docs","map","setState","bind","bookcount","show","setShow","fname","friendName","length","xxx","currentdata","undefined","deleted","color","width","index","uniqueId","marginBottom","paddingRight","Component","bookimagecheck","books","items","volumeInfo","imageLinks","thumbnail","descriptioncheck","descript","substring","authorCheck","authors","tempstring","authlen","i"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Card from 'react-bootstrap/Card';\nimport CardColumns from 'react-bootstrap/CardColumns';\nimport Button from 'react-bootstrap/Button'\nimport firebase from '../../firebase'\nimport './Library.css';\nimport ReactLoading from 'react-loading';\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\nimport Popover from 'react-bootstrap/Popover';\nimport Slide from 'react-reveal/Slide';\nimport * as login from '../Auth/Login.js';\nimport Avatar from 'react-avatar';\n\n\nconst BASE_URL = `https://www.googleapis.com/books/v1/volumes`;\nconst db = firebase.firestore();\n\n\n //if bookcount > 0 then display cards otherwise display \"you have no books here. Search for your favourites and add the to your library!\"\nexport default class Library extends React.Component{\nconstructor(props){\n  super(props);\n  this.state = {\n    bookcount: 0,\n    data: '',\n    delete: false,\n    show: false,\n    setShow: false,\n    current: \"\",\n    fname: \"\"\n}\n}\n\ncomponentDidMount() {\n  const { friendUid, friendName } = this.props.location.state;\n  this.setState({\n    fname: friendName\n  })\n  console.log(\"friends uid: \" + friendUid + \" \" + friendName)\n  db.collection(\"Users\")\n  .doc(friendUid).collection(\"Library\")\n    .get()\n    .then(querySnapshot => {\n      const data = querySnapshot.docs.map(doc => doc.data());\n      console.log(\"friends data: \" + data)\n      this.setState({\n        bookcount: data.length,\n        data:data\n       });\n       this.handleRemoveBook = this.handleRemoveBook.bind(this)\n    });\n}\naddBook = (name, author, image, description) => {\n  var addBook =\ndb.collection('Users').doc(login.getUID())\n.collection('Library')\n.doc(name)\n.set({\n  title: name,\n  author: author,\n  description: description,\n  coverurl: image\n})\n.then(function() {\nconsole.log(\"Document successfully written!\");\n})\n.catch(function(error) {\nconsole.error(\"Error writing document: \", error);\n});\n}\n\n\n getBooks(){\n   db.collection(\"Library\")\n   .get()\n   .then(querySnapshot => {\n  const data = querySnapshot.docs.map(doc => doc.data());\n  return data;\n  });\n }\n\n toolTap = (title, author, description, image) => {\n   return(\n     <Popover id=\"popover-basic\">\n     <Popover.Title as=\"h3\">{title}</Popover.Title>\n     <Popover.Content>\n       {description}\n       <br></br>\n       <Button variant=\"secondary\" type=\"submit\" onClick = { () =>\n         {this.addBook(\n           title,\n           author,\n           description,\n           image\n         )\n       }} size=\"sm\">Shelf</Button>\n     </Popover.Content>\n   </Popover>)\n }\n\n handleRemoveBook = (name) => {\n   var docRef = db.\n   collection(\"Library\")\n   .doc(name)\n   .delete()\n   .then(function() {\n     alert(\"Document deleted\");\n     window.location.reload();\n  })\n   .catch(function(error) {\n     console.error(\"Error deleting document: \", error);\n   });\n }\n\n setShow(show){\n   this.setState({\n     show: !show\n   })\n }\n\n current = (name, author, description, image) => {\n   const { friendUid } = this.props.location.state;\n   var addBook =\n   db.collection(\"Users\")\n   .doc(friendUid).collection(\"Library\")\n     .get()\n     .then(querySnapshot => {\n       const data = querySnapshot.docs.map(doc => doc.data());\n       console.log(\"friends data: \" + data)\n       this.setState({\n         current:data\n        });\n        this.handleRemoveBook = this.handleRemoveBook.bind(this)\n     });\n }\n\n\n\n    render(){\n      const xxx = \" \";\n      const { friendUid } = this.props.location.state;\n      db.collection('Users').doc(friendUid).get()\n      .then(querySnapshot => {\n      //var cata = querySnapshot.docs.map(doc => doc.data());\n    //  console.log(cata);\n     });\n\n      db.collection('Users').doc(friendUid)\n      .collection('CurrentBook')\n      .get()\n      .then(querySnapshot => {\n      var currentdata = querySnapshot.docs.map(doc => doc.data());\n      this.setState({\n        current: currentdata[0]\n      })\n     });\n      if(this.state.bookcount > 0){\n        if(this.state.current !== undefined){\n        var deleted = this.state.delete;\n        return(\n          <div className = 'library'>\n          <h1 style = {{color: \"white\"}}>{this.state.fname}'s Library </h1> \n            <CardColumns className = 'post'>\n            <Card className = 'currentRead'>\n            <Avatar className = \"ava\" name={this.state.fname} round={true}/>\n              <Card.Title>{this.state.fname} is reading</Card.Title>\n              <Card.Subtitle>{this.state.current.title} by {this.state.current.author}</Card.Subtitle>\n              <Card.Img style={{width : '100px'}} src={this.state.current.coverurl}></Card.Img>\n            </Card>\n        {this.state.data.map((data, index) => {\n         return(\n           <div>\n            <Slide bottom>\n            <Card className = 'imgCardlib' key={data.uniqueId}>\n            <OverlayTrigger trigger=\"click\" placement=\"bottom\" overlay={this.toolTap(data.title, data.author, data.description, data.coverurl)}>\n              <Card.Img data-tip data-for='clickme' data-event='click' variant=\"top\" src={data.coverurl} style = {{width: '10em', marginBottom: '30px', paddingRight: '0px'}} />\n              </OverlayTrigger>\n            </Card>\n            </Slide>\n          </div>\n    );})}\n      </CardColumns>\n      </div>\n    );\n  }else{\n    var deleted = this.state.delete;\n    return(\n      <div className = 'library'>\n      <h1 style = {{color: \"white\"}}>{this.state.fname}'s Library </h1>\n        <CardColumns className = 'post'>\n        <Card className = 'currentRead'>\n        <Avatar style = {{marginBottom: '30px'}} className = \"ava\" name={this.state.fname} round={true}/>\n          <Card.Title>{this.state.fname} is not reading anything!</Card.Title>\n        </Card>\n    {this.state.data.map((data, index) => {\n     return(\n       <div>\n        <Slide bottom>\n        <Card className = 'imgCardlib' key={data.uniqueId}>\n        <OverlayTrigger trigger=\"click\" placement=\"bottom\" overlay={this.toolTap(data.title, data.author, data.description, data.coverurl)}>\n          <Card.Img data-tip data-for='clickme' data-event='click' variant=\"top\" src={data.coverurl} style = {{width: '10em', marginBottom: '30px', paddingRight: '0px'}} />\n          </OverlayTrigger>\n        </Card>\n        </Slide>\n      </div>\n);})}\n  </CardColumns>\n  </div>\n);\n  }\n    }\n    return(\n      <div className = 'emptylibrary'>\n      {/*<p style = {{color: \"white\", fontSize: \"28px\", height: '85.7vh'}}>No books in your library.</p>*/}\n      <div className = 'loading'>\n        <ReactLoading type='cubes' height = '100vh' color='white' />\n      </div>\n      </div>\n    );\n  }\n  }\n\nfunction bookimagecheck(index, books){\n  if(books.items[index].volumeInfo.imageLinks === undefined){\n    console.log(\"undefined image! @ \" + books.items[index]);\n    return '../images/cannotfind.png';\n  }else{\n    return books.items[index].volumeInfo.imageLinks.thumbnail;\n  }\n}\n\nfunction descriptioncheck(index, books){\n  var descript = books.items[index].volumeInfo.description\n  var length = 135;\n  if(descript !== undefined){\n    if(descript.length >= length){\n      descript = descript.substring(0, length - 3) + \"...\"\n      return descript;\n    }else{\n      return descript;\n  }\n}else{\n  return \"no description available\";\n}\n}\n\nfunction authorCheck(index, books){\n  console.log(books.items[index].volumeInfo.authors)\n  if(books.items[index].volumeInfo.authors === undefined){\n    return '';\n  }else{\n    var tempstring = \"\"\n    var authlen = books.items[index].volumeInfo.authors.length;\n    for(var i = 0; i < authlen; i++){\n      if(authlen > 1){\n        if(i === authlen-1){\n          tempstring = tempstring + books.items[index].volumeInfo.authors[i]\n        }else{\n      tempstring = tempstring + books.items[index].volumeInfo.authors[i] + \", \"\n    }\n    }else{\n      tempstring = tempstring + books.items[index].volumeInfo.authors[i] + \" \"\n    }\n    }\n    return tempstring;\n  }\n}\n"]},"metadata":{},"sourceType":"module"}